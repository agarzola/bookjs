(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Book = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
!function(){function e(e,a){a||(a={}),this.min_load=a.min_load||3,this.page_turn_duration=a.page_turn_duration||400,this.ready=!1,this.turning=!1,this.target=null,this.current=[0],this.turn_queue=[],this.checkReadyState=setInterval(i,200,this),this.callback=null,this.images=r(this,e),this.markup=n(this),this.background.appendChild(t(this)),a.navigator&&(this.navigator=new p(this),this.background.appendChild(this.navigator.markup)),this.controls=f(this),this.current_page_label=this.controls.getElementsByClassName("Book_controls--current_page_label")[0],this.markup.appendChild(this.controls)}function t(e){var t=document.createElement("div");t.className="Book--nav_buttons";var n=document.createElement("button");n.type="button",n.setAttribute("tabindex",-1),n.innerText="Previous",n.className="Book--nav_buttons--prev",n.addEventListener("click",function(t){e.navigatePrev()});var r=document.createElement("button");return r.type="button",r.setAttribute("tabindex",-1),r.innerText="Next",r.className="Book--nav_buttons--next",r.addEventListener("click",function(t){e.navigateNext()}),t.appendChild(n),t.appendChild(r),t}function n(e){var t=document.createElement("section");t.id="Book",t.className="Book",t.innerHTML='<p class="Book--loading_message">Loading book pages&hellip;</p>';var n=document.createElement("div");return n.className="Book--background",t.appendChild(n),e.background=n,e.section=t,a(e),t}function r(e,t){for(var n,r,a="function"==typeof t?t():Array.isArray(t)?t:[t],i=[],s=0;s<a.length;s++)n=document.createElement("img"),n.addEventListener("load",o),n.addEventListener("load",u.bind(e)),n.setAttribute("src",a[s]),n.setAttribute("alt","Page "+(s+1)),r=document.createElement("figure"),r.className="Book_image_"+s,r.className+=s%2?" spread--left":" spread--right",r.setAttribute("data-loaded",!1),0===s?r.className+=" Book_image_displayed":r.className+=" Book_image_hidden--right",r.appendChild(n),i[s]=r;return i}function a(e){var t=document.createElement("div");t.className="Book--wrapper Book_layout--single";for(var n=0;n<e.images.length;n++)t.appendChild(e.images[n]);e.background.appendChild(t),e.container=t}function i(e){e.ready&&(clearInterval(e.checkReadyState),e.section.className+=" ready")}function o(e){var t=e.target;t.parentNode.setAttribute("data-loaded",!0)}function u(e){if(!this.ready){var t=this.images.slice(0,this.min_load-1).every(function(e){return"true"==e.getAttribute("data-loaded")});this.ready=t}}function s(e,t){if(e.current.indexOf(0)!==-1)return l(e);if(e.turning&&!t)return void e.turn_queue.push("Prev");e.turning=!0,e.close=e.current.slice(),e.current=e.current.map(function(t){return t-e.current.length}),1===e.current.length&&0!==e.current[0]&&e.current.splice(0,0,e.current[0]-1),2===e.current.length&&0===e.current[1]&&(e.current=e.current.slice(1));var n=1===e.current.length?"single":"spread";"single"==n?(d(e,"right"),m(e,"left"),setTimeout(function(){0===e.turn_queue.length?(g(e,n),setTimeout(l,1.5*e.page_turn_duration,e)):l(e)},1.8*e.page_turn_duration)):(g(e,n),setTimeout(function(){d(e,"right"),m(e,"left"),setTimeout(l,1.5*e.page_turn_duration,e)},1===e.close.length?e.page_turn_duration:0))}function c(e,t){if(e.current.indexOf(e.images.length-1)!==-1)return l(e);if(e.turning&&!t)return void e.turn_queue.push("Next");e.turning=!0,e.close=e.current.slice(),e.current=e.current.map(function(t){return t+e.current.length}),1===e.current.length&&e.current[0]!==e.images.length-1&&(e.current[1]=e.current[0]+1),2===e.current.length&&e.current[0]===e.images.length-1&&(e.current=e.current.slice(0,1));var n=1===e.current.length?"single":"spread";"single"==n?(d(e,"left"),m(e,"right"),setTimeout(function(){0===e.turn_queue.length?(g(e,n),setTimeout(l,1.5*e.page_turn_duration,e)):l(e)},1.8*e.page_turn_duration)):(g(e,n),setTimeout(function(){d(e,"left"),m(e,"right"),setTimeout(l,1.5*e.page_turn_duration,e)},1===e.close.length?e.page_turn_duration:0))}function l(e,t){if(0===e.turn_queue.length)return e.turning=!1,void(e.callback&&(e.callback(),e.callback=null));var n=e.turn_queue.splice(0,1)[0];e["navigate"+n](!t)}function g(e,t){e.container.className=e.container.className.replace(/Book_layout--\w+/,"Book_layout--"+t)}function d(e,t){for(var n=0;n<e.close.length;n++){var r=e.images[e.close[n]];r.className=r.className.replace(/ ?Book_image_displayed/,""),r.className+=" Book_image_behind",setTimeout(function(e,n){e.className=e.className.replace(/ ?Book_image_behind/," Book_image_hidden--"+t)},"right"==t?e.page_turn_duration*n:e.page_turn_duration-e.page_turn_duration*n,r,n)}}function m(e,t){for(var n=0;n<e.current.length;n++){var r=e.images[e.current[n]],a=new RegExp(" ?Book_image_hidden--"+t);r.className=r.className.replace(a,""),r.className+=" Book_image_opening--from_"+t,setTimeout(function(e,t){e.className=e.className.replace(/ ?Book_image_opening--from_\w+/," Book_image_displayed")},e.page_turn_duration,r,n)}}function h(e){var t="Page";return t+=e.current.length>1?"s: ":": ",t+=e.current.map(function(e){return 0===e?"Front cover":1===e?"Inside cover":51===e?"Back cover":parseInt(e)-1}).join(" & ")}function _(e,t){var t=parseInt(t);if(e.current.indexOf(t)===-1){if(e.turn_queue.length>0&&(e.turning=!1,e.turn_queue=[]),0!==t&&t%2===0&&t--,e.turning=!0,e.close=e.current.slice(),e.current=[t],0!==t&&t!==e.images.length-1&&e.current.push(t+1),e.current[0]>e.close[0])var n=e.close[0],r=e.current[0],a="left";else var n=e.current[0],r=e.close[0],a="right";for(var i=Math.abs(r-(0===n?n+1:n+2)),o=r-1;o>=r-i;o--)e.images[o].className=e.images[o].className.replace(/Book_image_hidden--\w*/,"Book_image_hidden_immediately--"+a),setTimeout(function(t){e.images[t].className=e.images[t].className.replace(/Book_image_hidden_immediately--\w*/,"Book_image_hidden--"+a)},10,o);var u=1===e.current.length?"single":"spread";"single"==u?(d(e,a),m(e,"left"===a?"right":"left"),setTimeout(function(){0===e.turn_queue.length?(g(e,u),setTimeout(l,1.5*e.page_turn_duration,e)):l(e)},1.8*e.page_turn_duration)):(g(e,u),setTimeout(function(){d(e,a),m(e,"left"===a?"right":"left"),setTimeout(l,1.5*e.page_turn_duration,e)},1===e.close.length?e.page_turn_duration:0))}}var p=require("./navigator"),f=require("./controls");module.exports=e,e.prototype.navigatePrev=function(e){s(this,"boolean"==typeof e?e:void 0),this.current_page_label.innerText=h(this),this.navigator&&this.navigator.updatePosition(this.current)},e.prototype.navigateNext=function(e){c(this,"boolean"==typeof e?e:void 0),this.current_page_label.innerText=h(this),this.navigator&&this.navigator.updatePosition(this.current)},e.prototype.navigateToPage=function(e){_(this,e),this.current_page_label.innerText=h(this)}}();
},{"./controls":2,"./navigator":3}],2:[function(require,module,exports){
!function(){function e(e){var o=document.createElement("div");o.className="booklet_controls";var l=t(e);if(l&&o.appendChild(l),e.navigator){var a=n();a&&o.appendChild(a)}var c=e.section,u=c.requestFullscreen||c.webkitRequestFullscreen||c.mozRequestFullScreen;if(u){var s=r(c,u);s&&o.appendChild(s)}return o}function t(e){var t=document.createElement("div");t.className="booklet_controls--prev_next";var n=document.createElement("button");n.type="button",n.className="booklet_controls--prev",n.innerText="Back",n.addEventListener("click",function(t){e.navigatePrev()}),t.appendChild(n);var r=document.createElement("p"),o=document.createElement("span");o.id="booklet_controls--current_page_label",o.className="booklet_controls--current_page_label",o.innerText="Page: Front cover";var l=document.createTextNode(" of "+(e.images.length-2));r.appendChild(o),r.appendChild(l),t.appendChild(r);var a=document.createElement("button");return a.type="button",a.className="booklet_controls--next",a.innerText="Forward",a.addEventListener("click",function(t){e.navigateNext()}),t.appendChild(a),t}function n(){var e=document.createElement("button");return e.type="button",e.className="booklet_controls--navigator_toggle",e.addEventListener("click",function(){var e=document.body;e.className.match(/show_navigator/)?e.className=e.className.replace(/ ?show_navigator/,""):e.className+=" show_navigator"}),e.innerText="Navigator",e}function r(e,t){function n(e){o.setAttribute("disabled",!0)}var r=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen,o=document.createElement("button");o.type="button",o.className="booklet_controls--fullscreen_toggle",o.addEventListener("click",function(){var n=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullscreenElement;n?r.call(document):t.call(e)});for(var l=["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","msfullscreenerror"],a=0;a<l.length;a++)document.addEventListener(l[a],n);return o.innerText="Full Screen",o}module.exports=e}();
},{}],3:[function(require,module,exports){
!function(){function t(t){this.min_load=7,this.buttons_to_display=5,this.ready=!1,this.thumbnails=[],this.hold_position=!1,this.buttons=e(this,t),this.markup=i(this)}function e(t,e){for(var a=[],i=e.images.reduce(function(t,n,a){var i={};return 0===a||a===e.images.length-1?(i[a]=e.images[a],t.push(i)):a%2!==0&&(i[a]=e.images[a],i[a+1]=e.images[a+1],t.push(i)),t},[]),r=0;r<i.length;r++){var l=document.createElement("button");l.className="navigator_button",l.className+=r<t.buttons_to_display?" displayed":"",l.className+=0===r?" selected":"",l.type="button",l.addEventListener("click",function(n){t.hold_position=!0,e.navigateToPage(this.getAttribute("data-page-id"),function(){t.hold_position=!1})}),l.addEventListener("click",function(e){n(t,null,this)});var u=1===Object.keys(i[r]).length,d=document.createElement("span");d.className="navigator_button--text",d.innerText="Jump to page"+(u?" ":"s "),d.innerText+=Object.keys(i[r]).map(function(t){return parseInt(t)+1}).join(" and "),l.appendChild(d),l.setAttribute("data-page-id",parseInt(Object.keys(i[r])[0]));for(var c in i[r]){var g=i[r][c].getElementsByTagName("img")[0],p=g.getAttribute("src").replace(/(\.\w+)$/,"_thumb$1"),h=document.createElement("img");h.addEventListener("load",o),h.addEventListener("load",s.bind(t)),h.setAttribute("src",p),h.setAttribute("alt","Thumbnail for page "+(parseInt(c)+1)),l.appendChild(h)}a.push(l)}return a}function n(t,e,n){if(!n&&e)var n=t.buttons.filter(function(t){return t.getAttribute("data-page-id")==e[0]})[0];for(var a=0;a<t.buttons.length;a++)t.buttons[a].className=t.buttons[a].className.replace(/ ?selected/,"");n.className+=" selected"}function a(t,e){var n=t.buttons.filter(function(t){return t.getAttribute("data-page-id")==e[0]})[0].parentNode,a=n.parentNode,i=n.getBoundingClientRect();if(i.left<72){var o=parseInt(window.getComputedStyle(a).getPropertyValue("left"));o+=i.left*-1,o+=72,a.style.left=o+"px"}else if(i.right>a.clientWidth-72){var o=parseInt(window.getComputedStyle(a).getPropertyValue("left"));o-=i.right-a.clientWidth,o-=72,a.style.left=o+"px"}}function i(t){var e=document.createElement("div");e.className="navigator_list";for(var n=document.createElement("ul"),a=0;a<t.buttons.length;a++){var i=document.createElement("li");i.className="navigator_list--item",i.className+=a%2?" even":" odd",i.appendChild(t.buttons[a]),n.appendChild(i)}var o=document.createElement("button");o.type="button",o.setAttribute("tabindex",-1),o.className="navigator_list--prev",o.innerText="Previous Pages",o.addEventListener("click",function(e){r.call(this,t,e)});var s=document.createElement("button");return s.type="button",s.setAttribute("tabindex",-1),s.className="navigator_list--next",s.innerText="Next Pages",s.addEventListener("click",function(e){l.call(this,t,e)}),e.appendChild(o),e.appendChild(n),e.appendChild(s),e}function o(t){var e=t.target;e.parentNode.setAttribute("data-loaded",!0)}function s(t){if(!this.ready){var e=this.buttons.slice(0,this.min_load-1).every(function(t){return"true"==t.getAttribute("data-loaded")});this.ready=e}}function r(t,e){var n=this.parentNode.getElementsByTagName("ul")[0],i=n.getBoundingClientRect();if(!(i.left>=72)){for(var o,s=0,r=0;r<t.buttons.length;r++){var l=t.buttons[r],u=l.getBoundingClientRect();u.left>=72&&u.right<=n.clientWidth-72&&(s--,o="number"==typeof o?o:r)}var d=t.buttons[o+s>=0?o+s:0];d&&a(t,[d.getAttribute("data-page-id")])}}function l(t,e){for(var n,i=this.parentNode.getElementsByTagName("ul")[0],o=0,s=0;s<t.buttons.length;s++){var r=t.buttons[s],l=r.getBoundingClientRect();l.left>=72&&l.right<=i.clientWidth-72&&(o++,n=s)}var u=t.buttons[n+o<=t.buttons.length-1?n+o:t.buttons.length-1];console.log(n,o,u),u&&a(t,[u.getAttribute("data-page-id")])}module.exports=t,t.prototype.navigatePrev=function(t){navigatePrev(this,"boolean"==typeof t?t:void 0)},t.prototype.navigateNext=function(t){navigateNext(this,"boolean"==typeof t?t:void 0)},t.prototype.updatePosition=function(t){n(this,t),this.hold_position||a(this,t)}}();
},{}]},{},[1])(1)
});


//# sourceMappingURL=book.js.map